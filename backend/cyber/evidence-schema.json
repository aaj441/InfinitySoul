{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://infinitysoul.com/schemas/cyber-scan-evidence-v1.0.0.json",
  "title": "Cyber Scan Evidence",
  "description": "Schema for InfinitySoul cyber scan evidence output files",
  "type": "object",
  "required": ["schemaVersion", "data", "metadata"],
  "properties": {
    "schemaVersion": {
      "type": "string",
      "description": "Schema version for this evidence format",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.0.0"]
    },
    "data": {
      "type": "object",
      "description": "Scout result data",
      "required": [
        "domain",
        "httpReachable",
        "httpsReachable",
        "securityHeaders",
        "openPorts",
        "rawFindings",
        "scannedAt"
      ],
      "properties": {
        "domain": {
          "type": "string",
          "description": "Domain name that was scanned",
          "examples": ["example.com"]
        },
        "resolvedIp": {
          "type": "string",
          "description": "Resolved IP address (IPv4)",
          "pattern": "^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$",
          "examples": ["93.184.216.34"]
        },
        "httpReachable": {
          "type": "boolean",
          "description": "Whether HTTP (port 80) is reachable"
        },
        "httpsReachable": {
          "type": "boolean",
          "description": "Whether HTTPS (port 443) is reachable"
        },
        "securityHeaders": {
          "type": "object",
          "description": "Security-related HTTP response headers",
          "properties": {
            "strict-transport-security": {
              "type": ["string", "null"],
              "description": "HSTS header value"
            },
            "x-frame-options": {
              "type": ["string", "null"],
              "description": "X-Frame-Options header value"
            },
            "x-content-type-options": {
              "type": ["string", "null"],
              "description": "X-Content-Type-Options header value"
            },
            "content-security-policy": {
              "type": ["string", "null"],
              "description": "CSP header value"
            },
            "x-xss-protection": {
              "type": ["string", "null"],
              "description": "X-XSS-Protection header value"
            }
          }
        },
        "openPorts": {
          "type": "array",
          "description": "List of open ports detected",
          "items": {
            "type": "integer",
            "minimum": 1,
            "maximum": 65535
          },
          "examples": [[80, 443]]
        },
        "rawFindings": {
          "type": "array",
          "description": "Free-form notes from scan execution",
          "items": {
            "type": "string"
          }
        },
        "scannedAt": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of when scan was performed"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Evidence file metadata",
      "required": ["generatedAt", "generator"],
      "properties": {
        "generatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of when evidence file was generated"
        },
        "generator": {
          "type": "string",
          "description": "Software that generated this evidence",
          "examples": ["InfinitySoul-CyberScout/1.0"]
        }
      }
    }
  },
  "examples": [
    {
      "schemaVersion": "1.0.0",
      "data": {
        "domain": "example.com",
        "resolvedIp": "93.184.216.34",
        "httpReachable": true,
        "httpsReachable": true,
        "securityHeaders": {
          "strict-transport-security": "max-age=31536000",
          "x-frame-options": "DENY",
          "x-content-type-options": "nosniff",
          "content-security-policy": "default-src 'self'",
          "x-xss-protection": null
        },
        "openPorts": [80, 443],
        "rawFindings": [
          "Resolved example.com to 93.184.216.34",
          "HTTP (port 80) is reachable",
          "HTTPS (port 443) is reachable",
          "Security header found: strict-transport-security"
        ],
        "scannedAt": "2024-01-15T10:30:45.123Z"
      },
      "metadata": {
        "generatedAt": "2024-01-15T10:30:46.789Z",
        "generator": "InfinitySoul-CyberScout/1.0"
      }
    }
  ]
}
